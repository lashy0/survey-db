<!-- app/templates/admin/partials/heatmap.html -->

<!-- Контейнер графика -->
<div id="chart-heatmap" class="w-full h-80 fade-in"></div>

<!-- Скрипт для отрисовки (выполнится сразу после вставки HTML) -->
<script>
    (function() {
        const fontConfig = { family: 'ui-sans-serif, system-ui, sans-serif', size: 12, color: '#4b5563' };
        
        const heatmapData = [{
            z: {{ heatmap_data.z | tojson }},
            x: {{ heatmap_data.x | tojson }},
            y: {{ heatmap_data.y | tojson }},
            type: 'heatmap',
            colorscale: 'PuBu', 
            showscale: true,
            xgap: 3, 
            ygap: 3, 
            hoverongaps: false,
            hovertemplate: 'День: <b>%{y}</b><br>Время: <b>%{x}</b><br>Ответов: <b>%{z}</b><extra></extra>'
        }];

        Plotly.newPlot('chart-heatmap', heatmapData, {
            margin: {t: 10, l: 50, r: 20, b: 50},
            yaxis: {
                autorange: 'reversed',
                tickfont: { ...fontConfig, size: 13, weight: 'bold' },
                ticksuffix: ' '
            },
            xaxis: {
                tickfont: fontConfig,
                dtick: 2,
                tickangle: 0
            },
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)',
        }, {displayModeBar: false, responsive: true});
    })();
</script>

<!-- Небольшая анимация появления -->
<style>
    .fade-in { animation: fadeIn 0.5s ease-in-out; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
</style>